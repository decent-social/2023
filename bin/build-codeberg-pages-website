#!/usr/bin/env bash -e

OUT_DIR="${OUT_DIR:-out}"
EXPORT_BASEPATH="${EXPORT_BASEPATH:-/website}"

help() {
cat << EOF
This script builds the website such that it can be pushed to the decentsocial/website repo[1]
and be served at https://decentsocial.codeberg.page/website.

This requires exporting the website with a next.js basePath of '/website'

[1]: https://codeberg.org/decentSocial/website
EOF
}

main() {
  NEXT_CONFIG_BASEPATH=$EXPORT_BASEPATH npm run build
  npx next export -o $OUT_DIR
}

if [[ "$1" == "-h" || "$1" == "--help" ]]; then
    help
    exit
fi

main
